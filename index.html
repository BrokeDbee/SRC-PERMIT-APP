<!DOCTYPE html>
<html data-bs-theme="light">
<head>
    <title>Knutsford University SRC Permit System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root[data-bs-theme="light"] {
            --bs-body-bg: #f8f9fa;
            --bs-body-color: #212529;
            --card-bg: #ffffff;
            --card-border: rgba(0, 0, 0, 0.125);
        }

        :root[data-bs-theme="dark"] {
            --bs-body-bg: #212529;
            --bs-body-color: #f8f9fa;
            --card-bg: #2c3034;
            --card-border: rgba(255, 255, 255, 0.125);
        }

        body {
            background-color: var(--bs-body-bg);
            color: var(--bs-body-color);
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, background-color 0.3s;
            background-color: var(--card-bg);
            border-color: var(--card-border);
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .nav-tabs {
            margin-bottom: 20px;
        }

        .nav-tabs .nav-link {
            color: var(--bs-body-color);
        }

        .nav-tabs .nav-link.active {
            color: #0d6efd;
            font-weight: bold;
        }

        .theme-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background-color: var(--card-bg);
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .theme-switcher .btn {
            margin: 0 5px;
            padding: 8px 15px;
        }

        .theme-switcher .btn i {
            margin-right: 5px;
        }

        .app-header {
            margin-top: 120px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }

        .app-title {
            font-size: 2rem;
            font-weight: bold;
            margin: 0;
            color: var(--bs-body-color);
            padding: 0 20px;
        }

        .qr-code {
            max-width: 200px;
            margin: 20px auto;
        }

        .quick-actions {
            z-index: 1000;
        }

        .quick-actions .btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .quick-actions .btn i {
            font-size: 1.2rem;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
        }

        .stat-card i {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .stat-card h3 {
            font-size: 1.8rem;
            margin: 10px 0;
        }

        .stat-card p {
            color: var(--bs-body-color);
            opacity: 0.7;
            margin: 0;
        }

        .list-group-item {
            background-color: var(--card-bg);
            color: var(--bs-body-color);
            border-color: var(--card-border);
        }

        .alert {
            background-color: var(--card-bg);
            border-color: var(--card-border);
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .receipt, .receipt * {
                visibility: visible;
            }
            .receipt {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .receipt .card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            .receipt .btn {
                display: none;
            }
            .receipt h5 {
                text-align: center;
                margin-bottom: 20px;
            }
            .receipt p {
                margin-bottom: 10px;
                border-bottom: 1px solid #eee;
                padding-bottom: 5px;
            }
        }

        .settings-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            min-width: 280px;
            max-width: 400px;
            min-height: 200px;
            max-height: 80vh;
            cursor: move;
            resize: both;
            overflow: auto;
            transition: box-shadow 0.2s ease;
        }

        .settings-menu:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .settings-menu .resize-handle {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 24px;
            height: 24px;
            cursor: se-resize;
            background: linear-gradient(135deg, transparent 50%, var(--bs-body-color) 50%);
            opacity: 0.2;
            border-radius: 0 0 8px 0;
            transition: opacity 0.2s ease;
        }

        .settings-menu .resize-handle:hover {
            opacity: 0.4;
        }

        .settings-menu .drag-handle {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 36px;
            cursor: move;
            background-color: var(--bs-body-bg);
            border-radius: 8px 8px 0 0;
            opacity: 0;
            transition: opacity 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-menu:hover .drag-handle {
            opacity: 0.1;
        }

        .settings-menu .drag-handle::after {
            content: "⋮";
            font-size: 20px;
            color: var(--bs-body-color);
            opacity: 0.5;
        }

        .settings-menu .btn {
            width: 100%;
            margin: 5px 0;
            text-align: left;
            padding: 8px 15px;
        }

        .settings-menu .btn i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .settings-menu .divider {
            height: 1px;
            background-color: var(--card-border);
            margin: 10px 0;
        }

        .settings-menu .theme-section {
            margin-bottom: 10px;
        }

        .settings-menu .theme-section .btn-group {
            width: 100%;
            display: flex;
            gap: 5px;
        }

        .settings-menu .theme-section .btn-group .btn {
            flex: 1;
            text-align: center;
            padding: 5px 10px;
        }

        .settings-menu .user-info {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            background-color: var(--bs-body-bg);
        }

        .settings-menu .user-info p {
            margin: 0;
            font-size: 0.9rem;
        }

        .container {
            max-width: 95%;
            margin-top: 20px;
            position: relative;
        }

        .content-spacer {
            height: 100px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="settings-menu" id="settingsMenu">
        <div class="drag-handle"></div>
        <div class="resize-handle"></div>
        <div id="userInfo" class="user-info" style="display: none;">
            <p class="mb-1"><i class="fas fa-user"></i> <span id="userInfoText"></span></p>
        </div>
        
        <div class="theme-section">
            <label class="form-label mb-2"><i class="fas fa-palette"></i> Theme</label>
            <div class="btn-group">
                <button class="btn btn-outline-primary" id="lightThemeBtn">
                    <i class="fas fa-sun"></i>
                </button>
                <button class="btn btn-outline-primary" id="darkThemeBtn">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="btn btn-outline-primary" id="systemThemeBtn">
                    <i class="fas fa-desktop"></i>
                </button>
            </div>
        </div>

        <div class="divider"></div>

        <div id="authButtons">
            <button class="btn btn-outline-primary" onclick="document.getElementById('login-tab').click()">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <button class="btn btn-outline-primary" onclick="document.getElementById('signup-tab').click()">
                <i class="fas fa-user-plus"></i> Sign Up
            </button>
        </div>

        <div id="userActions" style="display: none;">
            <button id="logoutBtn" class="btn btn-outline-danger">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            <button id="deleteAccountBtn" class="btn btn-outline-danger">
                <i class="fas fa-user-times"></i> Delete Account
            </button>
            <button id="deleteAllDataBtn" class="btn btn-outline-danger">
                <i class="fas fa-trash-alt"></i> Delete All Data
            </button>
        </div>
    </div>

    <div class="container">
        <div class="content-spacer"></div>
        <div class="app-header">
            <img src="./assets/knutsford_logo.png" alt="Knutsford University Logo" style="display:block;margin:0 auto 20px auto;max-width:200px;height:auto;object-fit:contain;">
            <h1 class="text-center app-title">Knutsford University SRC Permit System</h1>
        </div>
        
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="create-tab" data-bs-toggle="tab" href="#create" role="tab">Create Permit</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="verify-tab" data-bs-toggle="tab" href="#verify" role="tab">Verify Permit</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="revoke-tab" data-bs-toggle="tab" href="#revoke" role="tab">Revoke Permit</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="import-tab" data-bs-toggle="tab" href="#import" role="tab">Bulk Import</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="export-tab" data-bs-toggle="tab" href="#export" role="tab">Bulk Export</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="search-tab" data-bs-toggle="tab" href="#search" role="tab">Search</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="audit-tab" data-bs-toggle="tab" href="#audit" role="tab">Audit Logs</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="backup-tab" data-bs-toggle="tab" href="#backup" role="tab">Backup/Restore</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="delete-tab" data-bs-toggle="tab" href="#delete" role="tab">Delete Student</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="login-tab" data-bs-toggle="tab" href="#login" role="tab">Login</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="report-tab" data-bs-toggle="tab" href="#report" role="tab">Reports</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="bulk-tab" data-bs-toggle="tab" href="#bulk" role="tab">Bulk Operations</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="print-tab" data-bs-toggle="tab" href="#print" role="tab">Print Permits</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="signup-tab" data-bs-toggle="tab" href="#signup" role="tab">Sign Up</a>
            </li>
            <li class="nav-item" style="display: none;">
                <a class="nav-link" id="recover-tab" data-bs-toggle="tab" href="#recover" role="tab">Recover Password</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="stats-tab" data-bs-toggle="tab" href="#stats" role="tab">Statistics</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="validity-tab" data-bs-toggle="tab" href="#validity" role="tab">Check Validity</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="dashboard-tab" data-bs-toggle="tab" href="#dashboard" role="tab">Dashboard</a>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <!-- Dashboard Tab -->
            <div class="tab-pane fade" id="dashboard" role="tabpanel">
                <div class="row">
                    <!-- Quick Actions -->
                    <div class="col-md-4">
                        <div class="card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h5 class="card-title mb-0">Quick Actions</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-outline-primary" onclick="document.getElementById('create-tab').click()">
                                        <i class="fas fa-plus"></i> Create New Permit
                                    </button>
                                    <button class="btn btn-outline-success" onclick="document.getElementById('verify-tab').click()">
                                        <i class="fas fa-check"></i> Verify Permit
                                    </button>
                                    <button class="btn btn-outline-warning" onclick="document.getElementById('validity-tab').click()">
                                        <i class="fas fa-clock"></i> Check Validity
                                    </button>
                                    <button class="btn btn-outline-info" onclick="document.getElementById('search-tab').click()">
                                        <i class="fas fa-search"></i> Search Permits
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="col-md-8">
                        <div class="card mb-4">
                            <div class="card-header bg-info text-white">
                                <h5 class="card-title mb-0">Recent Activity</h5>
                            </div>
                            <div class="card-body">
                                <div id="recentActivity" class="list-group">
                                    <div class="text-center py-3">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Expiring Permits -->
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header bg-warning text-white">
                                <h5 class="card-title mb-0">Expiring Soon</h5>
                            </div>
                            <div class="card-body">
                                <div id="expiringPermits" class="list-group">
                                    <div class="text-center py-3">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Revenue Overview -->
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header bg-success text-white">
                                <h5 class="card-title mb-0">Revenue Overview</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-6">
                                        <h6>Today's Revenue</h6>
                                        <h3 id="todayRevenue">GHS 0.00</h3>
                                    </div>
                                    <div class="col-6">
                                        <h6>This Month</h6>
                                        <h3 id="monthRevenue">GHS 0.00</h3>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <canvas id="revenueChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Create Permit Tab -->
            <div class="tab-pane fade show active" id="create" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Create New Permit</h5>
                        <form id="createPermitForm">
                            <div class="mb-3">
                                <label for="studentId" class="form-label">Student ID</label>
                                <input type="text" class="form-control" id="studentId" required>
                            </div>
                            <div class="mb-3">
                                <label for="name" class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="name" required>
                            </div>
                            <div class="mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control" id="email" required>
                            </div>
                            <div class="mb-3">
                                <label for="course" class="form-label">Course</label>
                                <select class="form-select" id="course" required>
                                    <option value="">Select Course</option>
                                    <option value="Nursing">Nursing</option>
                                    <option value="Computer Science">Computer Science</option>
                                    <option value="IT">IT</option>
                                    <option value="Media">Media</option>
                                    <option value="Business Administration">Business Administration</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="level" class="form-label">Level</label>
                                <select class="form-select" id="level" required>
                                    <option value="">Select Level</option>
                                    <option value="100">100</option>
                                    <option value="200">200</option>
                                    <option value="300">300</option>
                                    <option value="400">400</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="amountPaid" class="form-label">Amount Paid</label>
                                <input type="number" class="form-control" id="amountPaid" required>
                            </div>
                            <div class="mb-3">
                                <label for="number" class="form-label">Number</label>
                                <input type="text" class="form-control" id="number" required>
                            </div>
                            <div class="mb-3">
                                <label for="validityPeriod" class="form-label">Validity Period (Days)</label>
                                <input type="number" class="form-control" id="validityPeriod" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Create Permit</button>
                        </form>
                        <div id="createResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Verify Permit Tab -->
            <div class="tab-pane fade" id="verify" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Verify Permit</h5>
                        <form id="verifyPermitForm">
                            <div class="mb-3">
                                <label for="permitCode" class="form-label">Permit Code</label>
                                <input type="text" class="form-control" id="permitCode" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Verify Permit</button>
                        </form>
                        <div id="verifyResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Revoke Permit Tab -->
            <div class="tab-pane fade" id="revoke" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Revoke Permit</h5>
                        <form id="revokePermitForm">
                            <div class="mb-3">
                                <label for="revokeStudentId" class="form-label">Student ID</label>
                                <input type="text" class="form-control" id="revokeStudentId" required>
                            </div>
                            <button type="submit" class="btn btn-danger">Revoke Permit</button>
                        </form>
                        <div id="revokeResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Bulk Import Tab -->
            <div class="tab-pane fade" id="import" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Bulk Import Students</h5>
                        <form id="importForm">
                            <div class="mb-3">
                                <label for="importFile" class="form-label">CSV File</label>
                                <input type="file" class="form-control" id="importFile" accept=".csv" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Import</button>
                        </form>
                        <div id="importResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Bulk Export Tab -->
            <div class="tab-pane fade" id="export" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Bulk Export Students</h5>
                        <form id="exportForm">
                            <div class="mb-3">
                                <label for="exportFile" class="form-label">Export to CSV</label>
                                <input type="text" class="form-control" id="exportFile" placeholder="Enter file path" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Export</button>
                        </form>
                        <div id="exportResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Search Tab -->
            <div class="tab-pane fade" id="search" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Search Students</h5>
                        <form id="searchForm">
                            <div class="mb-3">
                                <label for="searchQuery" class="form-label">Search Query</label>
                                <input type="text" class="form-control" id="searchQuery" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Search</button>
                        </form>
                        <div id="searchResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Audit Logs Tab -->
            <div class="tab-pane fade" id="audit" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Audit Logs</h5>
                        <div id="auditLogs" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Backup/Restore Tab -->
            <div class="tab-pane fade" id="backup" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Backup/Restore Database</h5>
                        <form id="backupForm">
                            <div class="mb-3">
                                <label for="backupPath" class="form-label">Backup Path</label>
                                <input type="text" class="form-control" id="backupPath" placeholder="Enter backup file path" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Backup</button>
                        </form>
                        <form id="restoreForm" class="mt-3">
                            <div class="mb-3">
                                <label for="restorePath" class="form-label">Restore Path</label>
                                <input type="text" class="form-control" id="restorePath" placeholder="Enter restore file path" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Restore</button>
                        </form>
                        <div id="backupResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Delete Student Tab -->
            <div class="tab-pane fade" id="delete" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Delete Student</h5>
                        <form id="deleteStudentForm">
                            <div class="mb-3">
                                <label for="deleteStudentId" class="form-label">Student ID</label>
                                <input type="text" class="form-control" id="deleteStudentId" required>
                            </div>
                            <button type="submit" class="btn btn-danger">Delete Student</button>
                        </form>
                        <div id="deleteResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Login Tab -->
            <div class="tab-pane fade" id="login" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Login</h5>
                        <form id="loginForm">
                            <div class="mb-3">
                                <label for="username" class="form-label">Username</label>
                                <input type="text" class="form-control" id="username" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="password" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Login</button>
                        </form>
                        <div id="loginResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Reports Tab -->
            <div class="tab-pane fade" id="report" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Reports</h5>
                        <div id="reportStats" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Bulk Operations Tab -->
            <div class="tab-pane fade" id="bulk" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Bulk Operations</h5>
                        <form id="bulkDeleteForm">
                            <div class="mb-3">
                                <label for="studentIds" class="form-label">Student IDs (comma-separated)</label>
                                <input type="text" class="form-control" id="studentIds" required>
                            </div>
                            <button type="submit" class="btn btn-danger">Bulk Delete</button>
                        </form>
                        <div id="bulkResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Print Permits Tab -->
            <div class="tab-pane fade" id="print" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Print Permits</h5>
                        <form id="printPermitForm">
                            <div class="mb-3">
                                <label for="printStudentId" class="form-label">Student ID</label>
                                <input type="text" class="form-control" id="printStudentId" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Print Permit</button>
                        </form>
                        <div id="printResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Sign Up Tab -->
            <div class="tab-pane fade" id="signup" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Sign Up</h5>
                        <form id="signupForm">
                            <div class="mb-3">
                                <label for="signupUsername" class="form-label">Username</label>
                                <input type="text" class="form-control" id="signupUsername" required>
                            </div>
                            <div class="mb-3">
                                <label for="signupPassword" class="form-label">Password</label>
                                <input type="password" class="form-control" id="signupPassword" required>
                            </div>
                            <div class="mb-3">
                                <label for="signupRole" class="form-label">Role</label>
                                <select class="form-select" id="signupRole" required>
                                    <option value="">Select Role</option>
                                    <option value="src_president">SRC President</option>
                                    <option value="src_vice">SRC Vice President</option>
                                    <option value="treasurer">Treasurer</option>
                                    <option value="external_affairs">External Affairs</option>
                                    <option value="internal_affairs">Internal Affairs</option>
                                    <option value="pro">PRO</option>
                                    <option value="deputy_pro">Deputy PRO</option>
                                    <option value="organizer">Organizer</option>
                                    <option value="deputy_organizer">Deputy Organizer</option>
                                    <option value="womens_commissioner">Women's Commissioner</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Sign Up</button>
                        </form>
                        <div id="signupResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Recover Password Tab -->
            <div class="tab-pane fade" id="recover" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Recover Password</h5>
                        <form id="recoverPasswordForm">
                            <div class="mb-3">
                                <label for="recoverEmail" class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="recoverEmail" required>
                                <div class="form-text">Enter the email address associated with your account.</div>
                            </div>
                            <div class="mb-3">
                                <label for="recoverUsername" class="form-label">Username</label>
                                <input type="text" class="form-control" id="recoverUsername" required>
                                <div class="form-text">Enter your username to verify your identity.</div>
                            </div>
                            <div class="mb-3">
                                <label for="recoverRole" class="form-label">Role</label>
                                <select class="form-select" id="recoverRole" required>
                                    <option value="">Select Role</option>
                                    <option value="src_president">SRC President</option>
                                    <option value="src_vice">SRC Vice President</option>
                                    <option value="treasurer">Treasurer</option>
                                    <option value="external_affairs">External Affairs</option>
                                    <option value="internal_affairs">Internal Affairs</option>
                                    <option value="pro">PRO</option>
                                    <option value="deputy_pro">Deputy PRO</option>
                                    <option value="organizer">Organizer</option>
                                    <option value="deputy_organizer">Deputy Organizer</option>
                                    <option value="womens_commissioner">Women's Commissioner</option>
                                </select>
                                <div class="form-text">Select your role to verify your identity.</div>
                            </div>
                            <button type="submit" class="btn btn-primary">Send Recovery Link</button>
                        </form>
                        <div id="recoverResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Statistics Tab -->
            <div class="tab-pane fade" id="stats" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">System Statistics</h5>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card bg-primary text-white mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title">Total Permits</h5>
                                        <h2 id="totalPermits">Loading...</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-success text-white mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title">Active Permits</h5>
                                        <h2 id="activePermits">Loading...</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-info text-white mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title">Total Students</h5>
                                        <h2 id="totalStudents">Loading...</h2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-4">
                                <div class="card bg-warning text-white mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title">Revoked Permits</h5>
                                        <h2 id="revokedPermits">Loading...</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-danger text-white mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title">Expired Permits</h5>
                                        <h2 id="expiredPermits">Loading...</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-secondary text-white mb-3">
                                    <div class="card-body">
                                        <h5 class="card-title">Total Revenue</h5>
                                        <h2 id="totalRevenue">Loading...</h2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Permits by Course</h5>
                                        <div id="courseChart" style="height: 300px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Check Validity Tab -->
            <div class="tab-pane fade" id="validity" role="tabpanel">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Check Permit Validity Status</h5>
                        <form id="checkValidityForm">
                            <div class="mb-3">
                                <label for="checkStudentId" class="form-label">Student ID</label>
                                <input type="text" class="form-control" id="checkStudentId" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Check Status</button>
                        </form>
                        <div id="validityResult" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer style="text-align:center;padding:18px 0 8px 0;color:#888;font-size:1rem;">
        App created by Broke Dbee Inc © 2025
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="renderer.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const settingsMenu = document.getElementById('settingsMenu');
            let isDragging = false;
            let isResizing = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;
            let initialWidth;
            let initialHeight;

            // Drag functionality
            settingsMenu.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            function dragStart(e) {
                if (e.target.closest('.drag-handle')) {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                    isDragging = true;
                    settingsMenu.style.transition = 'none';
                } else if (e.target.closest('.resize-handle')) {
                    initialWidth = settingsMenu.offsetWidth;
                    initialHeight = settingsMenu.offsetHeight;
                    initialX = e.clientX;
                    initialY = e.clientY;
                    isResizing = true;
                    settingsMenu.style.transition = 'none';
                }
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;

                    // Constrain to window boundaries
                    const maxX = window.innerWidth - settingsMenu.offsetWidth;
                    const maxY = window.innerHeight - settingsMenu.offsetHeight;
                    
                    currentX = Math.min(Math.max(0, currentX), maxX);
                    currentY = Math.min(Math.max(0, currentY), maxY);

                    xOffset = currentX;
                    yOffset = currentY;

                    setTranslate(currentX, currentY, settingsMenu);
                } else if (isResizing) {
                    e.preventDefault();
                    
                    const deltaX = e.clientX - initialX;
                    const deltaY = e.clientY - initialY;
                    
                    let newWidth = initialWidth + deltaX;
                    let newHeight = initialHeight + deltaY;

                    // Constrain dimensions
                    newWidth = Math.min(Math.max(newWidth, 280), 400);
                    newHeight = Math.min(Math.max(newHeight, 200), window.innerHeight * 0.8);

                    settingsMenu.style.width = `${newWidth}px`;
                    settingsMenu.style.height = `${newHeight}px`;
                }
            }

            function setTranslate(xPos, yPos, el) {
                el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0)`;
            }

            function dragEnd(e) {
                if (isDragging || isResizing) {
                    initialX = currentX;
                    initialY = currentY;
                    isDragging = false;
                    isResizing = false;
                    settingsMenu.style.transition = 'box-shadow 0.2s ease';
                    saveSettingsMenuState();
                }
            }

            function saveSettingsMenuState() {
                const state = {
                    transform: settingsMenu.style.transform,
                    width: settingsMenu.style.width,
                    height: settingsMenu.style.height,
                    xOffset: xOffset,
                    yOffset: yOffset
                };
                localStorage.setItem('settingsMenuState', JSON.stringify(state));
            }

            function loadSettingsMenuState() {
                const state = JSON.parse(localStorage.getItem('settingsMenuState'));
                if (state) {
                    settingsMenu.style.transform = state.transform;
                    settingsMenu.style.width = state.width;
                    settingsMenu.style.height = state.height;
                    xOffset = state.xOffset || 0;
                    yOffset = state.yOffset || 0;
                }
            }

            // Save state when resizing or dragging ends
            settingsMenu.addEventListener('mouseup', saveSettingsMenuState);
            settingsMenu.addEventListener('resize', saveSettingsMenuState);

            // Load saved state on page load
            loadSettingsMenuState();

            // Add double-click to reset position and size
            settingsMenu.addEventListener('dblclick', function(e) {
                if (e.target.closest('.drag-handle')) {
                    settingsMenu.style.transform = '';
                    settingsMenu.style.width = '';
                    settingsMenu.style.height = '';
                    xOffset = 0;
                    yOffset = 0;
                    saveSettingsMenuState();
                }
            });
        });
    </script>
</body>
</html> 